<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco Update Synthesizer</title>

    <!-- Import WebGL Earth, the library used to generate the interactive globe -->
    <!-- documentation at http://examples.webglearth.com/ and https://sites.google.com/site/webglearth/ -->
    <script src="http://www.webglearth.com/v2/api.js"></script>

    <!-- Import Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>

    <!-- Add Bootstrap and Bootstrap-Vue CSS to the <head> section -->
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"/>
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.css"/>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.js"></script>
</head>
<body>
    <b-container id="app">
        <b-row>

            <b-col cols="9">
                <div>11112</div>
                <div id="earth-div"></div>
            </b-col>
            
            <b-col cols="3">
                <div>
                    <ul id="articles-container">
                        <li v-for="article in articles">
                            [[ JSON.stringify(article) ]]
                        </li>
                    </ul>
                </div>
            </b-col>

            
        </b-row>
    </b-container>

    <script>

        const App = new Vue({
            el: "#app",

            // using [[ ]] as the Vue delimiters to avoid potential future conflicts with Jinja2 in Flask templates
            delimiters: ["[[", "]]"],

            data: {
                articles: [
                    {
                        id: 0,
                        headline: "headline",
                        url: "https://bbc.com",
                        image_url: "https://images.unsplash.com/photo-1615446636889-8dd69f9bdb35?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80"
                        ,
                        summary: "summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary "
                        ,
                        sentiment: ":)",
                    },
                    {
                        id: 1,
                        headline: "headline",
                        url: "https://bbc.com",
                        image_url: "https://images.unsplash.com/photo-1615446636889-8dd69f9bdb35?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80"
                        ,
                        summary: "summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary summary "
                        ,
                        sentiment: ":)",
                    }
                ],
            },

            // run when the DOM is mounted
            mounted() {
                const globeElementID = "earth-div";

                function initialize_globe() {
                    // equivalent to the documentation's initialize() function
                    var earth = new WE.map(globeElementID, {
                        sky: true, // adds stars to background
                    });
                    WE.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(earth);

                    var marker = WE.marker([51.5, -0.09]).addTo(earth);
                    marker.bindPopup("<b>Hello world!</b><br>I am a popup.<br /><span style='font-size:10px;color:#999'>Tip: Another popup is hidden in Cairo..</span>", {maxWidth: 150, closeButton: true}).openPopup();

                    var marker2 = WE.marker([30.058056, 31.228889]).addTo(earth);
                    marker2.bindPopup("<b>Cairo</b><br>Yay, you found me!", {maxWidth: 120, closeButton: false});

                    earth.setView([51.505, 0], 2);

                    
                    // Start a simple rotation animation
                    // http://examples.webglearth.com/#animation
                    var before = null;
                    requestAnimationFrame(function animate(now) {
                        var c = earth.getPosition();
                        var elapsed = before? now - before: 0;
                        before = now;
                        earth.setCenter([c[0], c[1] - 0.1*(elapsed/30)]);
                        requestAnimationFrame(animate);
                    });
                }

                window.addEventListener("load", () => {
                    initialize_globe();
                })
            },

            methods: {
                
            },
        })
    </script>
</body>
</html>

<style>
    /* These are taken directly from the WebGL Earth Documentation */
    html, body{padding: 0; margin: 0; background-color: black;}
    #earth-div{top: 0; right: 0; bottom: 0; left: 0; position: absolute !important;}

    /* this is to make text show up against black bg, remove this later once done testing */
    body {
        color: goldenrod;
    }
</style>
